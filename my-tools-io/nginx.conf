server {
  # Listen on port 8080, which is the default port Cloud Run expects
  listen 8080;
  server_name _;

  # Root directory where our React app's files are located
  root /usr/share/nginx/html;
  index index.html;

  location / {
    # This is the magic for SPAs (like React Router).
    # It tries to find a file matching the URI, then a directory,
    # and if neither exists, it falls back to serving /index.html.
    try_files $uri $uri/ /index.html;
  }

  # Optional: Improve caching for static assets
  location ~* \.(?:css|js|png|jpg|jpeg|gif|ico|svg)$ {
      expires 1y;
      add_header Cache-Control "public";
  }
}